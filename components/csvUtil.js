export function downloadCSV(filename, rows){ if(!rows||!rows.length) return; const header = Object.keys(rows[0]); const csv = [ header.join(','), ...rows.map(r => header.map(h => '"'+(String(r[h]||'')).replace(/"/g,'""')+'"').join(',') ).join('\n') ]; const blob = new Blob([csv.join('\n')], { type: 'text/csv;charset=utf-8;' }); const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.setAttribute('download', filename); document.body.appendChild(link); link.click(); document.body.removeChild(link); }
